<div class="panel-container">
  <form [formGroup]="goalsForm!">
    <!-- This template displays the overlay content and is connected to the button -->
    <ng-template
      cdkConnectedOverlay
      [cdkConnectedOverlayOrigin]="trigger"
      [cdkConnectedOverlayOpen]="isOpen">
      <app-goal-overlay
        [goal]="selectedGoal"
        (closeOverlay)="isOpen = false"></app-goal-overlay>
    </ng-template>

    <div
      cdkOverlayOrigin
      #trigger="cdkOverlayOrigin"
      class="overlay-dock"></div>
    <div class="config-group">
      <mat-radio-group
        name="treatmentGoalSelect"
        aria-label="Select an option"
        class="layer-radio-group"
        color="primary"
        formControlName="selectedQuestion">
        <app-scenario-tooltip
          area="TREATMENT_GOALS"
          title="TREATMENT GOALS"></app-scenario-tooltip>
        <div
          *ngFor="let treatmentGoal of treatmentGoals$ | async"
          class="goal-control-container">
          <mat-expansion-panel expanded="true" [togglePosition]="'before'">
            <mat-expansion-panel-header class="goal-panel-header">
              {{ treatmentGoal['category_name'] }}
            </mat-expansion-panel-header>
            <div
              *ngFor="let treatmentQuestion of treatmentGoal['questions']"
              class="layer-control-container">
              <mat-radio-button
                [value]="treatmentQuestion"
                (click)="selectGoal(treatmentQuestion)">
                <div
                  [matTooltip]="treatmentQuestion.long_question_text || ''"
                  matTooltipPosition="right"
                  matTooltipClass="long-question-tooltip"
                  class="short-question">
                  {{ treatmentQuestion.short_question_text }}
                </div>
              </mat-radio-button>
            </div>
          </mat-expansion-panel>
        </div>
      </mat-radio-group>
    </div>
  </form>
</div>
