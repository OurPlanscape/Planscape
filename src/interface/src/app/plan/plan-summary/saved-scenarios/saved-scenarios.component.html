<div class="saved-scenarios-wrapper">
  <mat-card [style.margin-top]="'24px'">
    <div class="scenario-table-head">
      <mat-card-title>Scenarios</mat-card-title>
      <div class="new-scenario-button">
        <button
          matSuffix
          mat-raised-button
          color="primary"
          *ngIf="canAddScenarioForPlan()"
          data-id="new-scenario"
          (click)="openConfig()">
          <mat-icon class="material-symbols-outlined">add_box</mat-icon>
          NEW SCENARIO
        </button>
      </div>
    </div>

    <app-section-loader
      [isLoading]="loading"
      (onlyMyScenariosToggle)="onMyScenariosToggle($event)"
      [hasData]="activeScenarios.length + archivedScenarios.length > 0"
      [ngClass]="{
        'margin-top': activeScenarios.length + archivedScenarios.length === 0
      }"
      emptyStateTitle="No scenarios yet"
      [emptyStateContent]="
        canAddScenarioForPlan()
          ? 'Click “New scenario” to start creating your scenarios.'
          : ''
      ">
      <mat-tab-group
        mat-align-tabs="start"
        *appFeatureFlag="'show_share_modal'"
        (selectedTabChange)="tabChange($event)">
        <mat-tab label="ACTIVE">
          <mat-card-content>
            <app-scenarios-table-list
              *ngIf="activeScenarios.length > 0"
              [scenarios]="activeScenarios"
              [highlightedScenarioRow]="highlightedScenarioRow"
              (viewScenario)="viewScenario()"
              (selectScenario)="
                highlightScenario($event)
              "></app-scenarios-table-list>

            <div class="empty-state" *ngIf="activeScenarios.length === 0">
              No active scenarios
            </div>
          </mat-card-content>
        </mat-tab>
        <mat-tab label="ARCHIVED">
          <mat-card-content>
            <app-scenarios-table-list
              *ngIf="archivedScenarios.length > 0"
              [scenarios]="archivedScenarios"
              [highlightedScenarioRow]="highlightedScenarioRow"
              (viewScenario)="viewScenario()"
              (selectScenario)="
                highlightScenario($event)
              "></app-scenarios-table-list>
            <div class="empty-state" *ngIf="archivedScenarios.length === 0">
              No scenarios in Archived.
            </div>
          </mat-card-content>
        </mat-tab>
      </mat-tab-group>

      <mat-card-content *appFeatureFlag="'show_share_modal'; hide: true">
        <app-scenarios-table-list
          [scenarios]="activeScenarios"
          [highlightedScenarioRow]="highlightedScenarioRow"
          (viewScenario)="viewScenario()"
          (selectScenario)="
            highlightScenario($event)
          "></app-scenarios-table-list>
      </mat-card-content>
      <mat-card-actions
        align="end"
        *appFeatureFlag="'show_share_modal'; hide: true">
        <button
          mat-button
          [disabled]="highlightedScenarioRow === null"
          (click)="confirmDeleteScenario()">
          <mat-icon>delete</mat-icon>
          DELETE
        </button>
        <button
          mat-raised-button
          [disabled]="highlightedScenarioRow === null"
          color="primary"
          (click)="viewScenario()">
          VIEW
        </button>
      </mat-card-actions>
      <mat-card-actions align="end" *appFeatureFlag="'show_share_modal'">
        <button
          class="ghost-button"
          [disabled]="highlightedScenarioRow === null"
          (click)="toggleScenarioStatus(selectedTabIndex === 0)">
          <mat-icon>{{
            selectedTabIndex === 0 ? 'archive' : 'unarchive'
          }}</mat-icon>
          {{ selectedTabIndex === 0 ? 'Archive' : 'Restore' }}
        </button>
        <button
          [disabled]="highlightedScenarioRow === null"
          class="ghost-button"
          (click)="viewScenario()">
          <mat-icon>description</mat-icon>
          View scenario
        </button>
      </mat-card-actions>
    </app-section-loader>
  </mat-card>
</div>
