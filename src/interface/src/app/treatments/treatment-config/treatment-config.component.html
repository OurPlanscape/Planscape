<app-nav-bar [breadcrumbs]="(breadcrumbs$ | async) || []" [area]="'TREATMENTS'">
  <app-treatment-navbar-menu
    [treatmentPlanName]="(treatmentPlanName$ | async) || ''"
    (treatmentPlanDeleted)="redirectToScenario()"
    (goToDuplicatedPlan)="
      redirectToNewPlan($event)
    "></app-treatment-navbar-menu>
</app-nav-bar>
<section class="treatment">
  <div class="left-side">
    <router-outlet></router-outlet>
  </div>
  <div class="right-side">
    <app-treatment-map></app-treatment-map>
    <section class="right-side-footer">
      <ng-container *ngIf="projectAreaId$ | async; else treatment">
        <a sg-button variant="primary" class="footer-primary" routerLink="./">
          Done
        </a>
      </ng-container>
      <ng-template #treatment>
        <mat-slide-toggle
          color="primary"
          [checked]="(showTreatmentLayer$ | async) || false"
          (change)="toggleShowTreatmentLayers()"
          >View Treatment Layers
        </mat-slide-toggle>
        <div class="right-footer-right-box">
          <button
            sg-button
            variant="text"
            icon="ios_share"
            [outlined]="true"
            (click)="printTreatment()"
            data-id="print">
            Export Plan to PDF
          </button>
          <button
            sg-button
            variant="primary"
            class="footer-primary"
            (click)="showReviewDialog()">
            Run Impacts
          </button>
        </div>
      </ng-template>
    </section>

    <app-apply-treatment
      *ngIf="showApplyTreatments$ | async"></app-apply-treatment>

    <app-treatment-legend
      *ngIf="(showTreatmentLegend$ | async) || false"></app-treatment-legend>
  </div>
</section>

<div class="printable-footer" *ngIf="summary$ | async; let summary">
  <div class="print-project-area" *ngFor="let pa of summary.project_areas">
    <div class="print-project-area-name">{{ pa.project_area_name }}</div>
    <div *ngFor="let rx of pa.prescriptions">
      <div *ngIf="rx.type === 'SINGLE'">
        <div class="print-rx-name">
          {{ prescriptionName(rx.action, rx.type) }}
        </div>
      </div>
      <div *ngIf="rx.type === 'SEQUENCE'">
        <div *ngFor="let seqDetail of sequenceActions(rx.action)">
          <span class="print-seq-detail">{{ seqDetail }}</span>
        </div>
      </div>
    </div>
  </div>
</div>
