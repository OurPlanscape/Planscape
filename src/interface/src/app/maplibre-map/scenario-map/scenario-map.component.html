<app-map-nav-bar>
  <sg-opacity-slider
    class="navbar-slider"
    [minValue]="0"
    [maxValue]="1"
    [step]="0.01"
    [sliderValue]="(projectAreasOpacity$ | async) ?? 0.5"
    (valueChange)="handleOpacityChange($event)"></sg-opacity-slider>
</app-map-nav-bar>

<mgl-map
  *ngIf="bounds$ | async as bounds"
  [style]="(baseLayerUrl$ | async) || ''"
  [transformRequest]="transformRequest"
  [maxZoom]="17"
  [minZoom]="7"
  [dragRotate]="false"
  [fitBoundsOptions]="{ padding: 20 }"
  [fitBounds]="bounds"
  (mapLoad)="mapLoaded($event)">
  <app-map-controls
    [mapLibreMap]="mapLibreMap"
    controlsPosition="bottom-right"
    [extendedControlsEnabled]="false">
  </app-map-controls>

  <!-- This *ngIf="true" is a hack to fix the issue where the planning area was displayed on top of the project areas when moving back and forward. -->
  <app-planning-area-layer *ngIf="true"></app-planning-area-layer>

  <ng-container *ngIf="showProjectAreas$ | async">
    <app-map-project-areas
      *ngIf="projectAreaCount$ | async as projectAreasCount"
      [projectAreasCount]="projectAreasCount"
      [showHoveredProjectAreas]="false"
      [mapLibreMap]="mapLibreMap">
    </app-map-project-areas>
  </ng-container>
</mgl-map>
